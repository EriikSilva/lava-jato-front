<p-dialog
  [(visible)]="chamarModalPagamento"
  (onHide)="closeDialog()"
  [style]="{ width: '1250px', height: '700px' }"
  [header]="'Pagamento'"
  [modal]="true"
  styleClass="p-fluid"
  [draggable]="false"
>
  <div class="container">
    <div class="left-element">
      <form [formGroup]="pagamentoForm">
        <div class="field">
          <label for="vl_desconto_p">Desconto R$:</label>
          <p-inputNumber
          placeholder="Desconto"
          mode="currency"
          currency="BRL"
          [maxlength]="12"
          formControlName="vl_desconto_p"
          (ngModelChange)="calcularPrecoComDesconto($event)"
          >
          </p-inputNumber>
          <div class="flex flex-wrap gap-3">
            <div class="flex align-items-center">
                <p-radioButton name="desconto" value="desconto" [(ngModel)]="tipoDesconto" inputId="desconto"></p-radioButton>
                <label for="desconto" class="ml-2">Desconto em dinheiro</label>
            </div>
            <div class="flex align-items-center">
              <p-radioButton name="porcentual" value="porcentual" [(ngModel)]="tipoDesconto" inputId="porcentual"></p-radioButton>
              <label for="porcentual" class="ml-2">Porcentual</label>
          </div>
            </div>
        </div>
        <div class="field">
          <label for="perc_desc_p">Desconto em percentual:</label>
          <p-inputNumber 
          formControlName="perc_desc_p"
          [maxlength]="3"
          (ngModelChange)="calcularDescontoPercentual($event)"
          inputId="percent" 
          prefix="%"></p-inputNumber>
        </div>
        <div class="field"> 
          <label for="pagamentos">Formas de Pagamento:</label>
          <p-multiSelect 
          [style]="{'max-width':'590px'}"
          [options]="formasDePagamento" 
          formControlName="pagamentos"
          defaultLabel="Selecione as formas de pagamento" 
          optionLabel="pagamentoEparcelas" 
          display="chip"
          (onChange)="onMultiSelectChangePagamento($event)"
          ></p-multiSelect>
        </div>
        <div class="field" *ngFor="let pagamento of selectedPagamentos">  
          <label for="pagamentos">{{pagamento.descricao}}:</label>
          <p-inputNumber
           placeholder="Digite o valor do {{pagamento.descricao}}"
           mode="currency"
           currency="BRL"
           [maxlength]="12"
           >
           </p-inputNumber>
        </div>
      </form>
    </div>
    <div class="right-element">
      <p-table 
      [value]="servicos" 
      [tableStyle]="{ 'max-width': '37rem' }">
        <ng-template pTemplate="header">
            <tr>
                <th>Servi√ßo</th>
                <th>Status</th>
                <th>Valor</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-servico>
            <tr>
                <td>{{ servico.servico }}</td>
                <td>{{ servico.status_servico == "A" ? 'Aberto': 'Fechado' }}</td>
                <td>{{ servico.valor | currency : "BRL" : "symbol" }}</td>
            </tr>
        </ng-template>
    </p-table>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <h3 class="valor_total_servico">TOTAL: {{precoFinal <= 0 ? "R$ 0" : precoFinal | currency : "BRL" : "symbol"}}</h3>
    <button
    pButton
    pRipple
    label="Cancelar"
    class="p-button-text"
    (click)="closeDialog()"
  ></button>

  <button
  [disabled]="desabilitarBotao"
  pButton
  pRipple
  label="Salvar"
  [loading]="buttonLoading"
  class="p-button-text"
  (click)="pagamento()"
  ></button>

  </ng-template>

</p-dialog>
